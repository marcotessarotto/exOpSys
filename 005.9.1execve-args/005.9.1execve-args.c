#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>


extern char **environ;  /* Or define _GNU_SOURCE to get it from <unistd.h> */

/*
 * 005.9.1execve-args /usr/bin/ls -l /home
 *
 * (il programma esegue il comando:
 * /usr/bin/ls -l /home
 * )
 *
 *
 */


int main(int argc, char * argv[]) {

	if (argc == 1) {
		printf("i parametri a riga di comando di questo programma\n"
				"diventano il programma (con i suoi parametri) da eseguire con execve\n"
				"esempio:\n"
				"%s /usr/bin/ls -l /home\n", argv[0]);
		exit(1);
	}

	char * program_filename = argv[1];

	// parametri per il programma che invocheremo con execve
	char ** new_arguments = calloc(argc, sizeof(char *));

	for (int i = 1; i < argc; i++) {
		new_arguments[i-1] = argv[i];
	}

	execve(program_filename, new_arguments,
			environ);

	perror("execve");

	return 1;
}

